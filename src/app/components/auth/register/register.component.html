<div class="register-container">
    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">

        <!-- Nombre de la organización -->
        <div class="form-group">
            <label>Nombre de la organización</label>
            <input type="text" formControlName="organizationName" class="form-input">
            <small
                *ngIf="registerForm.get('organizationName')?.touched && registerForm.get('organizationName')?.invalid"
                class="error">
                El nombre de la organización es obligatorio
            </small>
        </div>

        <!-- Roles -->
        <div class="form-group">
            <label>Roles (puede seleccionar múltiples)</label>
            <div *ngIf="loadingRoles" class="text-sm text-gray-500">Cargando roles...</div>
            <div *ngIf="!loadingRoles" class="roles-container">
                <label *ngFor="let role of availableRoles; let i = index" class="checkbox-label">
                    <input 
                        type="checkbox" 
                        [formControl]="getRoleControl(i)"
                        class="checkbox-input">
                    <span>{{ role.displayName }}</span>
                </label>
            </div>
            <small *ngIf="registerForm.get('roles')?.touched && registerForm.get('roles')?.hasError('minRoles')" class="error">
                Debe seleccionar al menos un rol
            </small>
            <small *ngIf="registerForm.get('roles')?.touched && registerForm.get('roles')?.invalid && !registerForm.get('roles')?.hasError('minRoles')" class="error">
                Debe seleccionar al menos un rol
            </small>
        </div>

        <!-- Nombre de usuario -->
        <div class="form-group">
            <label>Nombre de usuario</label>
            <input type="text" formControlName="username" class="form-input">
            <small *ngIf="registerForm.get('username')?.touched && registerForm.get('username')?.invalid" class="error">
                El nombre de usuario es obligatorio
            </small>
        </div>

        <!-- Contraseña -->
        <div class="form-group">
            <label>Contraseña</label>
            <input type="password" formControlName="password" class="form-input">
            <div *ngIf="registerForm.get('password')?.touched && registerForm.get('password')?.invalid" class="error-messages">
                <small *ngIf="registerForm.get('password')?.hasError('required')" class="error">
                    La contraseña es obligatoria
                </small>
                <small *ngIf="registerForm.get('password')?.hasError('minlength')" class="error">
                    La contraseña debe tener al menos 8 caracteres
                </small>
                <small *ngIf="registerForm.get('password')?.hasError('passwordLowercase')" class="error">
                    La contraseña debe contener al menos una letra minúscula
                </small>
                <small *ngIf="registerForm.get('password')?.hasError('passwordUppercase')" class="error">
                    La contraseña debe contener al menos una letra mayúscula
                </small>
                <small *ngIf="registerForm.get('password')?.hasError('passwordNumber')" class="error">
                    La contraseña debe contener al menos un número
                </small>
                <small *ngIf="registerForm.get('password')?.hasError('passwordSpecial')" class="error">
                    La contraseña debe contener al menos un carácter especial
                </small>
            </div>
        </div>

        <!-- Confirmar contraseña -->
        <div class="form-group">
            <label>Confirmar contraseña</label>
            <input type="password" formControlName="confirmPassword" class="form-input">
            <small *ngIf="registerForm.hasError('passwordMismatch') && registerForm.get('confirmPassword')?.touched"
                class="error">
                Las contraseñas no coinciden
            </small>
        </div>

        <!-- Botón de envío -->
        <button type="submit" class="btn-submit">Registrarse</button>

    </form>
</div>